<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Couple OS (MVP)</title>
  <style>
    body{font-family:system-ui,-apple-system,BlinkMacSystemFont,"Hiragino Sans",sans-serif;max-width:720px;margin:40px auto;padding:0 16px}
    h1{font-size:22px}
    .row{display:flex;gap:8px}
    input{flex:1;padding:10px;border:1px solid #ccc;border-radius:10px}
    button{padding:10px 14px;border:0;border-radius:10px;cursor:pointer}
    ul{padding-left:18px}
    li{margin:8px 0}
    .done{text-decoration:line-through;opacity:.6}
    small{color:#666}
  </style>
</head>
<body>
  <h1>Couple OS（まずはToDo）</h1>
  <small>※これは“動く確認用”。次に共有DBとリマインドを足す。</small>

  <div class="row" style="margin-top:14px">
    <input id="txt" placeholder="例：牛乳買う / 病院に電話 / デート予約" />
    <button id="add">追加</button>
  </div>

  <ul id="list"></ul>

  <script>
    const key = "couple_os_todos";
    const txt = document.getElementById("txt");
    const list = document.getElementById("list");
    const addBtn = document.getElementById("add");

    function load(){
      try { return JSON.parse(localStorage.getItem(key) || "[]"); }
      catch { return []; }
    }
    function save(items){
      localStorage.setItem(key, JSON.stringify(items));
    }
    function render(){
      const items = load();
      list.innerHTML = "";
      items.forEach((it, idx) => {
        const li = document.createElement("li");
        li.className = it.done ? "done" : "";
        li.innerHTML = `
          <label style="display:flex;gap:10px;align-items:center">
            <input type="checkbox" ${it.done ? "checked":""} />
            <span style="flex:1">${it.title}</span>
            <button data-del="${idx}">削除</button>
          </label>`;
        li.querySelector("input").addEventListener("change", (e)=>{
          items[idx].done = e.target.checked;
          save(items); render();
        });
        li.querySelector("button").addEventListener("click", ()=>{
          items.splice(idx,1); save(items); render();
        });
        list.appendChild(li);
      });
    }
    function add(){
      const v = txt.value.trim();
      if(!v) return;
      const items = load();
      items.unshift({title:v, done:false, createdAt: Date.now()});
      save(items);
      txt.value = "";
      render();
    }
    addBtn.addEventListener("click", add);
    txt.addEventListener("keydown", (e)=>{ if(e.key==="Enter") add(); });
    render();
  </script>
</body>
</html>
